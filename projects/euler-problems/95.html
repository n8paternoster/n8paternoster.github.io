<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Nathan Paternoster | Project Euler Problem 95</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="stylesheet" type="text/css" href="/css/nate.css" />
    <link rel="stylesheet" type="text/css" href="/css/projects.css" />
    <noscript><link rel="stylesheet" type="text/css" href="/css/no-js.css" /></noscript>
    <script src="/js/nate.js" defer></script>
    <script src="https://kit.fontawesome.com/254df2922f.js" crossorigin="anonymous"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <div id="page-wrapper">

        <!-- Top navigation bar -->
        <ul class="topnav">
            <li><a href="/index.html">Nathan Paternoster</a></li>
            <li><a href="/coursework.html">Coursework</a></li>
            <li><a href="/projects.html">Projects</a></li>
            <li><a href="/recordings.html">Recordings</a></li>
            <li><a href="/contact.html">Contact</a></li>
        </ul>

        <!-- Page content -->
        <div class="content">
            <div class="euler-problem-link-container">
                <a href="../euler.html" class="back-link"><i class="fas fa-arrow-left"></i>&nbsp;Back to Problems</a>
                <div class="euler-problem-links">
                    <a href="https://projecteuler.net/problem=95" target="_blank"><i class="fas fa-link"></i>&nbsp;Problem 95 on Project Euler</a>
                    <a href="https://github.com/n8paternoster/Project-Euler/blob/master/Problems/Sources/76-100/95.cpp" target="_blank"><i class="fas fa-code"></i>&nbsp;Problem 95 Code</a>
                </div>
            </div>
            <h1 id="euler-problem-title">Problem 95 - Amicable Chains</h1>
            <div class="euler-problem-view">
                <button class="accordion" type="button">View problem</button>
                <div class="accordion-panel">
                    <blockquote cite="https://projecteuler.net/problem=95">
                        <p>The proper divisors of a number are all the divisors excluding the number itself. For example, the proper divisors of 28 are 1, 2, 4, 7, and 14. As the sum of these divisors is equal to 28, we call it a perfect number.</p>
                        <p>Interestingly the sum of the proper divisors of 220 is 284 and the sum of the proper divisors of 284 is 220, forming a chain of two numbers. For this reason, 220 and 284 are called an amicable pair.</p>
                        <p>Perhaps less well known are longer chains. For example, starting with 12496, we form a chain of five numbers:</p>
                        <p>12496 → 14288 → 15472 → 14536 → 14264 (→ 12496 → ...)</p>
                        <p>Since this chain returns to its starting point, it is called an amicable chain.</p>
                        <p>Find the smallest member of the longest amicable chain with no element exceeding one million.</p>
                    </blockquote>
                </div>
            </div>
            <hr />
            <section>
                <h2>Divisor Function</h2>
                <p>This problem requires us to find the longest chain of amicable numbers. This means we'll need to think about this in the context of graph theory and apply an appropriate algorithm to detect chains, or <i>cycles</i>, within a graph. However, before we can begin that, we first have the problem of building our graph - that is, finding all of the amicable numbers. </p>
                <p>It's helpful to work through this problem in a bottom-up approach. First, we'll find an efficient way to generate all of the proper divisors of a number <i>n</i>. The simplest way to achieve this is by testing every number &lt; <i>n</i> to see which are divisible by <i>n</i>. However, performing this for the required first million numbers will be very time consuming - on the order of <i>n</i><sup>2</sup> operations.</p>
                <p>Instead, we can use a faster method that relies on the distinct prime factors of <i>n</i>. The sum of divisors (&sigma;) of <i>n</i> is given by:</p>
                <div class="mathjax-block">
                    <p>\(\sigma(n) = \prod\limits_{i=1}^{r}{\frac{p_i^{a_i+1}-1}{p_i-1}}\)</p><br />
                    <p>where</p>
                    <p><i>r</i> = the number of distinct prime factors of <i>n</i></p>
                    <p><i>p<sub>i</sub></i> = the <i>i</i>th prime factor</p>
                    <p><i>a<sub>i</sub></i> = the multiplicity of <i>p<sub>i</sub></i></p>
                </div>
                <p>Here, the multiplicity means the number of times <i>p<sub>i</sub></i> divides <i>n</i>. Using this formula only requires finding the distinct prime factors of <i>n</i> rather than testing the divisibility of every number &lt; <i>n</i>. For a large amount of numbers, this process can be sped up by pre-calculating the prime numbers.</p>
            </section>

            <div id="end-page-links">
                <a href="/projects/euler-problems/93.html" id="prev-problem"><i class="fas fa-arrow-left"></i>&nbsp;Previous: Arithmetic expressions</a>
                <a href="/projects/euler-problems/59.html" id="next-problem">Next: XOR decryption&nbsp;<i class="fas fa-arrow-right"></i></a>
            </div>
        </div>

        <div id="push"></div>
    </div>

    <!-- Footer -->
    <footer>
        <p>Website &copy; <span id="year">2020</span> Nathan Paternoster</p>
        <script>
            var d = new Date();
            document.getElementById("year").innerHTML = d.getFullYear();
        </script>
    </footer>
</body>
</html>